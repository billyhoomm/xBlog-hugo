---
title: Shell脚本笔记整理（一） 变量、字符串
subtitle: 
date: 2019-03-10
tags: ["运维", "shell"]
draft: true
---

内容源于网上视频教程，自己整理下供需要时查询。

<!--more-->

## 变量替换
```
将字符串型的变量自身进行各种删除替换操作
```

1. ${变量名#匹配规则}

    从变量开头规则匹配，将符合最短的数据删除。

2. ${变量名##匹配规则}

    从变量开头规则匹配，将符合最长的数据删除。

3. ${变量名%匹配规则}

    从变量尾部规则匹配，将符合最短的数据删除。

4. ${变量名%%匹配规则}

    从变量尾部规则匹配，将符合最长的数据删除。

5. ${变量名/旧字串/新字串}

    第一个符合旧字串的被新字串替换。

6. ${变量名//旧字串/新字串}

    所有符合旧字串的被新字串替换

```shell


str="Hello World，Hello Jim."

# 从开头匹配 选择最短的语句
echo ${str#*el}
lo World，Hello Jim.

# 从开头匹配 选择最长（贪婪匹配）的语句
echo ${str##*el}
lo Jim.

# 从结尾匹配 选择最短的语句
echo ${str%el*}
Hello World，H

# 从结尾匹配 选择最长（贪婪匹配）的语句
echo ${str%%el*}
H                                   # el开头的语句都被删除，仅剩H

# 第一个符合旧字串的被新字串替换
echo ${str/Hello/Goodbye}
Goodbye World，Hello Jim.

# 所有符合旧字串的被新字串替换
echo ${str//Hello/Goodbye}
Goodbye World，Goodbye Jim.
```

## 字符串处理

### 计算字符串长度

#### 变量名前加#号，${#string}

```
str="Hello World，Hello Jim."
echo ${#str}
22
```

#### expr计数器，expr length "$string"

如果字符串带空格，必须用双引号括起来。

```
str="Hello World，Hello Jim."
expr length "$str"
24
```

### 获取子串在字符串中的索引位置

expr index $string $substring

```
str="Hello World，Hello Jim."
expr index "$str" "Jim"           # 如果变量带空格 必须有双引号
21
```

### 计算子串长度

expr match $string $substring

### 截取字符串

1. ${string:position}

    从string中的position开始

2. ${string:position:length}

    从position开始，匹配长度为length

3. ${string:-position}

    从右边开始匹配

4. ${string:(position)}

    从左边开始匹配

5. expr substr $string $position $length

    从position开始，匹配长度为length